% ============================================
% environments.tex â€” GUARDED THEOREM ENVIRONMENTS
% ============================================

% Numbering by section (only if not already set)
\numberwithin{equation}{section}

\makeatletter
% Helper: define theorem-like env only if undefined
\newcommand{\SafeNewTheorem}[3][]{%
  \@ifundefined{#2}{\newtheorem{#2}{#3}[#1]}{}%
}
\newcommand{\SafeNewTheoremNoReset}[2]{%
  \@ifundefined{#1}{\newtheorem{#1}{#2}}{}%
}
\makeatother

% Main theorem family (reset each section)
\SafeNewTheorem{theorem}{Theorem}
\SafeNewTheoremNoReset{lemma}{Lemma}
\SafeNewTheoremNoReset{proposition}{Proposition}
\SafeNewTheoremNoReset{corollary}{Corollary}

% Definition/remark styles
\theoremstyle{definition}
\SafeNewTheoremNoReset{definition}{Definition}
\SafeNewTheoremNoReset{assumption}{Assumption}

\theoremstyle{remark}
\SafeNewTheoremNoReset{remark}{Remark}
\SafeNewTheoremNoReset{example}{Example}

% Cleveref names (only once; harmless if repeated)
\providecommand{\crefname}[3]{\@ifundefined{cref@#1@name}{\def\cref@#1@name{#2}\def\Cref@#1@name{#3}}{}}
\providecommand{\Crefname}[3]{}

% (Names below are used by cleveref; if cleveref loaded, these help formatting.)
\crefname{theorem}{theorem}{theorems}
\crefname{lemma}{lemma}{lemmas}
\crefname{proposition}{proposition}{propositions}
\crefname{corollary}{corollary}{corollaries}
\crefname{definition}{definition}{definitions}
\crefname{assumption}{assumption}{assumptions}
\crefname{remark}{remark}{remarks}
\crefname{example}{example}{examples}
\crefname{equation}{equation}{equations}
